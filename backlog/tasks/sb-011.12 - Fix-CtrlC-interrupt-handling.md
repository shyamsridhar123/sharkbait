# Fix Ctrl+C to Cancel Operation Instead of Exit

| Field | Value |
|-------|-------|
| ID | SB-011.12 |
| Parent | SB-011 |
| Status | done |
| Priority | high |
| Created | 2026-01-29 |
| Completed | 2026-01-29 |

## Description

PRD Section 5.6 requires: "User can interrupt with Ctrl+C"

Currently, Ctrl+C exits the entire application. Expected behavior:
- During operation: Cancel current operation, return to prompt
- At idle prompt: Exit application

## Acceptance Criteria

- [ ] Ctrl+C during LLM streaming cancels the request
- [ ] Show "Cancelled" message
- [ ] Return to input prompt
- [ ] Ctrl+C at empty prompt exits app
- [ ] Graceful cleanup of cancelled operations

## Technical Notes

1. Track execution state:
```tsx
const [isExecuting, setIsExecuting] = useState(false);
```

2. Handle Ctrl+C based on state:
```tsx
useInput((input, key) => {
  if (key.ctrl && input === 'c') {
    if (isExecuting) {
      abortController.abort();
      setMessages(prev => [...prev, { role: "system", content: "Cancelled." }]);
      setIsExecuting(false);
    } else {
      exit();
    }
  }
});
```

3. Pass AbortController to LLM client:
```typescript
async *chat(messages, tools, options?: { signal?: AbortSignal }) {
  // Check signal.aborted during streaming
}
```

4. Clean up partial state on cancel
