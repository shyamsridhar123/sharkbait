---
id: SB-003.02
title: Implement shell execution tool
status: Completed
assignee: []
created_date: '2026-01-29 05:36'
updated_date: '2026-01-28'
labels: []
dependencies: []
parent_task_id: TASK-3
priority: high
---

## Description

<!-- SECTION:DESCRIPTION:BEGIN -->
run_command with timeout, output capture, stdin support, background processes.

**Action Reversibility Classification (NEW):**
Per Microsoft Research Magentic-One guidance, classify all actions by reversibility:

| Reversibility | Examples | Behavior |
|---------------|----------|----------|
| `EASY` | git checkout, mkdir | Proceed with logging |
| `EFFORT` | git push, npm publish | Warn, provide undo command |
| `IRREVERSIBLE` | rm -rf /, DROP DATABASE | Block, require explicit confirmation |

**Implementation:**
- Replace regex-only patterns with `Reversibility` enum
- Provide `undoCommand` where applicable
- Use argument arrays instead of raw template strings for safety
<!-- SECTION:DESCRIPTION:END -->

## Acceptance Criteria

- [ ] run_command with timeout and output capture
- [ ] Background process support
- [ ] **Reversibility classification system**
- [ ] **Block irreversible actions by default**
- [ ] **Provide undo commands where applicable**
- [ ] Safe command execution (argument arrays, not raw strings)

## References

- TRD Section 4.2: Shell Execution
